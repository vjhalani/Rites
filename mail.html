<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mails...Varun</title>
    <!-- Add Bootstrap CSS link -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<style>
    html {
        scroll-behavior: smooth;
    }
    
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        transition: background-color 0.3s ease;
    }
    
    .navbar {
        background-color: #3a4664;
    }
    
    .navbar-brand {
        color: #ffffff;
        font-size: 1.5rem;
        font-weight: bold;
        font-style: italic;
    }
    
    .navbar-nav .nav-link {
        color: #ffffff;
    }
    
    .navbar-nav .nav-link:hover {
        color: #f8f9fa;
    }
    
    /* Navbar Toggler */
    .navbar-toggler-icon {
        background: none;
        border: none;
        width: 24px;
        height: 2px;
        position: relative;
    }
    
    .navbar-toggler-icon::before,
    .navbar-toggler-icon::after {
        content: '';
        display: block;
        background-color: #fff;
        width: 100%;
        height: 2px;
        position: absolute;
        transition: transform 0.3s ease;
    }
    
    .navbar-toggler-icon::before {
        top: -6px;
    }
    
    .navbar-toggler-icon::after {
        bottom: -6px;
    }
    
    /* Toggled state */
    .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon::before {
        transform: rotate(45deg);
    }
    
    .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon::after {
        transform: rotate(-45deg);
    }
    
    .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon {
        background: transparent;
    }
    
    /* Form styles */
    label {
        display: block;
        margin-bottom: 5px;
    }
    
    input,
    textarea {
        width: 100%;
        padding: 8px;
        margin-bottom: 15px;
        box-sizing: border-box;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    button {
        cursor: pointer;
        margin-right: 10px;
    }
    
    /* Table styles */
    table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 20px;
    }
    
    th,
    td {
        border: 3px solid #ddd;
        padding: 12px 8px;
        text-align: left;
    }
    
    th {
        font-size: 0.8rem;
        background-color: #fffcfe;
        color: black;
        font-weight: 600;
        padding: 6px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
 
    h2 { font-size: 1.25rem;
        text-align: left;
        margin-bottom: 15px;
    }


    #claimsDetailsTable th, #claimsDetailsTable td {
        border: none;
        padding: 12px 8px;
        border-bottom: 1px solid #ddd;
    }
    #claimsDetailsTable th {
        font-weight: normal;
        border-bottom: 2px solid #ddd;
    }
    /* #claimsDetailsTable tbody tr:hover {
        background-color: #f9f9f9;
    } */
</style>

</head>

<body>
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">    
                <a class="navbar-brand" href="#">Mails</a>
                

               
            </div>    
                 <!-- 'How to Use' button-->
                <a class="btn btn-outline-info btn-sm rounded-pill ml-auto" style="font-style:italic;" href="https://www.loom.com/share/96d4028ab44040c897b335df79aad414?sid=4bd5d591-fe56-46a7-8a52-2b9d32ad8a55" target="_blank" onclick="window.location.href='#'">
                    How to Use
                </a>             
            <!-- Navbar toggler button for smaller screens-->
            <!-- <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button> -->
    
            <!-- Navbar collapsible content -->
            <!-- <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="btn btn-sm btn-link" style="color: whitesmoke;" href="https://docs.google.com/document/d/1ZOGdUfyXb0XWu-swrG5kjQ0PQ7IiWlQHyEgfs2vocic/edit" target="_blank" onclick="window.location.href='#'">
                            Gift Vouchers Format & Ids
                        </a>
                    </li>
                </ul>
            </div> -->
        </div>
    </nav>
    

    <div id="popupOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); align-items: center; justify-content: center; z-index: 999;color: black;">
        <div style="background: white; padding: 20px; border-radius: 5px;">
            <p id="popupMessage"></p>
        </div>
    </div>

    <div class="container" style="padding-top: 100px;">
        <form id="emailForm">

            <!-- Data copying button -->
            <!-- <div class="mb-1" style="text-align: right;">
                <button type="button" class="btn btn-sm btn-outline-light rounded-pill"style="color: #896790; border-color: #896790;" onclick="copyToGSheet()">Copy Mail Record</button>
            </div> -->

             <label for="vendorDetails" style="font-weight: bold;">VENDOR DETAILS:</label>

             <table class="table" id="vendorDetailsTable" style="box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 100%; border-collapse: collapse; border-top: 2px solid #ddd;">
                <thead>
                    <tr>
                        <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Feed ID</th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Type</th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Title</th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">SKU</th>
                        <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Service</th>
                        <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Seller</th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                        <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="vendorRow">
                        <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control feedid" id="feedId" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control type" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control title" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control sku" required></td>
                        <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control category" id="serviceName" required></td>
                        <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control seller" id="vendorName" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control blank" id="vendorName" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control blank" id="vendorName" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control blank" id="vendorName" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control blank" id="vendorName" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control blank" id="vendorName" required></td>
                        <td style="display: none; border: none;"><input type="text" class="form-control blank" id="vendorName" required></td>
                    </tr>
                </tbody>
            </table>
                                    
            <label for="claimsDetails" style="font-weight: bold; padding-top: 20px;">CLAIM DETAILS:</label>
            <div class="table-responsive">
                <table class="table" id="claimsDetailsTable" style="box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 100%; border-collapse: collapse; border-top: 2px solid #ddd;">
                    <thead>
                        <tr>
                            <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">S.No</th>
                            <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Department Name</th>
                            <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Work Order Number</th>
                            <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Project Value</th>
                            <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Project Start Date</th>
                            <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Project End Date</th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; display: none; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;"></th>
                            <th style="font-weight: normal; border: none; border-bottom: 2px solid #ddd; padding: 12px 8px;">Buyer Designation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="claimRow" id="claimRow">
                            <td style="border: none; padding: 12px 8px;">
                                <button type="button" id="clearAllButton" class="btn btn-light" onclick="clearClaimsDetailsTable()">Clear</button>
                            </td>
                            <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control workOrderNumber" required></td>
                            <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control buyerDepartment" required></td>
                            <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control projectValue" required></td>
                            <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control startDate" required></td>
                            <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control endDate" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="display:none; border: none;"><input type="text" class="form-control" required></td>
                            <td style="border: none; padding: 12px 8px;"><input type="text" class="form-control BuyerDesignation" required></td>
                        </tr>
                    </tbody>
                </table>

            </div>
            <div class="buttons" style="padding: 15px 2px 5px 2px; align-items: center; display: flex; justify-content: center;">
                <button type="button" class="btn btn-secondary rounded-pill"style="background-color:#896790; border: none; " onclick="generateEmail()">Generate Mail</button>
                <button type="button" class="btn btn-secondary rounded-pill"style="background-color:#896790; border: none; " onclick="copyToClipboard()">Copy Mail</button>
                <button type="button" class="btn btn-secondary rounded-pill"style="background-color:#896790; border: none;" onclick="copySubject()">Copy Subject</button>
                <button type="button" class="btn btn-outline-light rounded-pill"style="color: #896790; border-color: #896790;" onclick="copyToGSheet()">Copy Record</button>
            </div>           
        </form>
       <hr>

        <h3 style="text-align: center; letter-spacing: 1px; font-weight: normal;">PREVIEW</h3>
         <div id="emailSubject" style="visibility: none;"></div>
        <div id="emailPreview"></div>
    </div>
    <script>
    function clearClaimsDetailsTable() 
    {
        console.log("Clear button clicked");
        var claimsDetailsTable = document.getElementById('claimsDetailsTable');
        var claimsDetailsBody = claimsDetailsTable.getElementsByTagName('tbody')[0];
        
        // Getting all rows in the table body
        var rows = claimsDetailsBody.getElementsByTagName('tr');

        //iterating from the second row (index 1) to the last row
        for (var i = 1; i < rows.length; i++) {
            // Remove the current row
            claimsDetailsBody.removeChild(rows[i]);
        }
    }
    </script>
    <script>
        function generateEmail() {
            var vendorName = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByClassName('seller')[0].value;
            var serviceName = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByClassName('category')[0].value;
            var feedId = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByClassName('feedid')[0].value;

            var claimsDetailsTable = document.getElementById('claimsDetailsTable');
            var claimsDetailsBody = claimsDetailsTable.getElementsByTagName('tbody')[0];
            var rows = claimsDetailsBody.getElementsByTagName('tr');
            var claimsDetails = '';

            for (var i = 1; i < rows.length; i++) { // Start from 1 to EXclude header row
                var cells = rows[i].getElementsByTagName('td');
                var buyerDepartment = cells[1].textContent;
                var workOrderNumber = cells[2].textContent;
                var projectValue = cells[3].textContent;
                var startDate = cells[4].textContent;
                var endDate = cells[5].textContent;
                var buyerDesignation = cells[14].textContent;

                claimsDetails += `<tr>
                                    <td>${i}</td>
                                    <td>${workOrderNumber}</td>
                                    <td>${projectValue}</td>
                                    <td>${startDate}</td>
                                    <td>${endDate}</td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
            }
        // Concatenate buyer name with designation and department separated by comma
            var buyerName = buyerDesignation + ', ' + buyerDepartment;
            
            var subject = `To seek confirmation regarding ${vendorName} registering as a service provider on the GeM portal.`;
            var emailTemplate = `Dear Sir/Ma’am,<br>
            Greetings from GeM!<br>
            <br>
            This is to seek confirmation regarding <b>${vendorName}</b> registering as a service provider on the GeM portal. The seller claims to have provided the following:<br>
            <br>
            <b>Service Name:</b> ${serviceName}<br>
            <b>Buyer Name:</b> ${buyerName}<br>
            <br>
            Below are the details shared by the service provider (Feed ID: <b>${feedId}</b>) on the GeM portal for further verification.<br>
            <br>
            <table style="border: 1px solid black; border-collapse: collapse;">
                <tr>
                    <th rowspan="2">S.No.</th>
                    <th colspan="4">Claims as per the Service Provider</th>
                    <th colspan="2">To be filled by the recipient department</th>
                </tr>
                <tr>
                    <th>Work Order Number</th>
                    <th>Project Value</th>
                    <th>Project Start Date</th>
                    <th>Project End Date</th>
                    <th>Confirmation (Y/N)</th>
                    <th>Remarks(If any)</th>
                </tr>
                ${claimsDetails}
            </table>
            <br>
            <i><b>Note:</b> The completion document/work order/relevant documents (the document uploaded by the service provider) has been attached for your reference.</i><br>
            <br>
            Please revert to the same mail in Yes/No if credentials mentioned above are correct as per your records.<br>
            <br>
            Yes–If documents/details provided are authentic<br>
            No–If documents/details provided are not authentic<br>
            <br>
            In this regard, we request you to please confirm whether the document submitted by the service provider is true and correct or not, The document uploaded by the service provider has been attached for your reference.<br>
            <br>
            Request you to please reply to the mail at the earliest of your convenience or within the next 4 days. In case of any query, please contact the undersigned.<br>
            <br>
            Also, please be informed that the GeM is a trust-based portal and therefore, it is imminent to verify the documents submitted by the service providers from the concerned Buyer department, otherwise, it may lead to possible forgery at the GeM portal. Considering the gravity of the situation, we request you to please take this on an urgent basis.<br>
            <br>
            Thanking You,<br>
            Ganesh K Ingole<br>
            Contact: 8600017722<br>
            Government e-Marketplace (GeM)<br>
            Ministry of Commerce & Industry`;

            document.getElementById('emailPreview').innerHTML = emailTemplate;
            document.getElementById('emailSubject').innerText = subject;
            document.getElementById('claimRow').scrollIntoView(); //to scroll down while pressing generate button
            showPopup('Email generated successfully!');
        }
            $(document).ready(function () {
                $('.dropdown-toggle').dropdown();
            });
            function showPopup(message) {
                // Set the popup message
                document.getElementById('popupMessage').innerText = message;

                // Show the overlay
                document.getElementById('popupOverlay').style.display = 'flex';

                // Hide the overlay after 3 seconds
                setTimeout(function () {
                    document.getElementById('popupOverlay').style.display = 'none';
                }, 1000);
            }

            function copyToClipboard() {
                    var emailPreview = document.getElementById('emailPreview');
                    var range = document.createRange();
                    range.selectNode(emailPreview);
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                    document.execCommand('copy');
                    window.getSelection().removeAllRanges();
                    showPopup('Email copied to clipboard!');
                }

           function copySubject() {
                    var emailSub = document.getElementById('emailSubject');
                    var range = document.createRange();
                    range.selectNode(emailSub);
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                    document.execCommand('copy');
                    window.getSelection().removeAllRanges();
                    showPopup('Subject copied to clipboard!');
                }

                document.addEventListener('contextmenu', function (e) {
                  e.preventDefault();
                });
               document.addEventListener('contextmenu', function (e) {
                    e.preventDefault();
                });  
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.8/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
    // Function to clear input fields in the claims details table
    document.getElementById('clearAllButton').addEventListener('click', clearClaimsDetailsTable);
    </script>
    <script>
                document.addEventListener('DOMContentLoaded', function () {
                    document.getElementById('claimsDetailsTable').addEventListener('paste', handlePaste);
                });
        function handlePaste(e) {
            var clipboardData, pastedData;

            // Get clipboard data
            clipboardData = e.clipboardData || window.clipboardData;
            pastedData = clipboardData.getData('text');

            // Split pasted data into rows and columns
            var rows = pastedData.split('\n');

            // Get the tbody element of the claimsDetailsTable
            var tbody = document.getElementById('claimsDetailsTable').getElementsByTagName('tbody')[0];

            // Get the current number of rows in the table
            var existingRowCount = tbody.getElementsByTagName('tr').length;

            // Create a new row for pasted data
            var newRow = document.createElement('tr');

            // Create and append the serial number cell
            var serialNumberCell = document.createElement('td');
            serialNumberCell.textContent = existingRowCount; // Serial number for the new row
            newRow.appendChild(serialNumberCell);

            // Loop through each row of pasted data
            for (var i = 0; i < rows.length; i++) {
                var rowData = rows[i].split('\t');

                // Loop through each column of pasted data
                for (var j = 0; j < 5; j++) { // Loop through first 5 columns
                    var newCell = document.createElement('td');
                    newCell.textContent = rowData[j];
                    newRow.appendChild(newCell);
                }

                // Add the last column
                var lastColumnCell = document.createElement('td');
                lastColumnCell.textContent = rowData[rowData.length - 1]; // Last column
                newRow.appendChild(lastColumnCell);
            }

            // Append the new row to the tbody
            tbody.appendChild(newRow);

            // Hide the columns to hide
            hideColumns();

            e.preventDefault(); // To Prevent default paste behavior
        }

        function hideColumns() {
            var tableRows = document.getElementById('claimsDetailsTable').getElementsByTagName('tr');
            for (var i = 0; i < tableRows.length; i++) {
                var cells = tableRows[i].getElementsByTagName('td');
                for (var j = 1; j < cells.length - 1; j++) { // Hide columns except the first 5 and the last column
                    if (j <= 5 || j === cells.length - 1) { // Show first 5 and last column, hide the rest
                        cells[j].style.display = '';
                    } else {
                        cells[j].style.display = 'none';
                    }
                }
            }
        }
        function copyToGSheet() {
            var vendorDetailsTable = document.getElementById('vendorDetailsTable');
            var vendorDetailsBody = vendorDetailsTable.getElementsByTagName('tbody')[0];
            var rows = vendorDetailsBody.getElementsByTagName('tr');
            var dataToCopy = [];

            // Get current date in the desired format
            var currentDate = new Date();
            var options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
            var formattedDate = currentDate.toLocaleDateString('en-US', options);

            for (var i = 0; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName('td');
                var rowData = [];

                for (var j = 0; j < cells.length; j++) {
                    var cellData = cells[j].querySelector('input') ? cells[j].querySelector('input').value : cells[j].innerText;
                    // Replacing "pending" with "In-Progress" in the last column
                    if (j === cells.length - 1 && cellData.toLowerCase() === "pending") {
                        cellData = "In-Progress";
                    }
                    rowData.push(cellData);
                }
                // Add the formatted date in the last column
                rowData.push(formattedDate);
                dataToCopy.push(rowData.join('\t')); // Tab-separated values for Google Sheets
            }

            // Copy data to clipboard
            navigator.clipboard.writeText(dataToCopy.join('\n')).then(function() {
                showPopup('Data Copied to Clipboard!');
                // alert("Data copied to clipboard!");
            }, function(err) {
                console.error("Could not copy text: ", err);
            });
}

        function handleVendorPaste(e) {
            var clipboardData, pastedData;

            // Get clipboard data
            clipboardData = e.clipboardData || window.clipboardData;
            pastedData = clipboardData.getData('text');

            // Split pasted data into rows and columns
            var rows = pastedData.split('\n');
            var firstRowCells = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByTagName('td');

            // Loop through each row of pasted data
            for (var i = 0; i < rows.length; i++) {
                var rowData = rows[i].split('\t');
                if (rowData.length !== firstRowCells.length) {
                    alert('Pasted data does not have the correct number of columns.');
                    return;
                }

                // Update the cells of the first row with pasted data
                for (var j = 0; j < rowData.length; j++) {
                    // Check if the cell exists
                    if (firstRowCells[j]) {
                        // Update the cell value
                        firstRowCells[j].getElementsByTagName('input')[0].value = rowData[j].trim();
                    } else {
                        // If the number of cells in the pasted data exceeds the number of cells in the table, add a new row
                        var newRow = document.createElement('tr');
                        for (var k = 0; k < rowData.length; k++) {
                            var newCell = document.createElement('td');
                            newCell.innerHTML = '<input type="text" class="form-control" value="' + rowData[k].trim() + '" required>';
                            newRow.appendChild(newCell);
                        }
                        document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].appendChild(newRow);
                    }
                }
            }

            e.preventDefault(); // Prevent default paste behavior
        }

        // Attach the handleVendorPaste function to the paste event of the vendorDetailsTable
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('vendorDetailsTable').addEventListener('paste', handleVendorPaste);
        });
    </script>

</body>
</html>
