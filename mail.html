<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VSP Varun Jhalani</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
    <!-- Add Bootstrap CSS link -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0; /* Remove the margin to stick the navbar to the top */
            transition: background-color 0.3s ease;
        }

        .navbar {
            background-color: #0F3850; /* Dark background color */
            transition: background-color 0.3s ease;
        }

        .navbar-brand {
            color: #ffffff; /* White text color */
            font-size: 1.5rem;
            font-weight: bold;
        }

        .navbar-nav .nav-link {
            color: #ffffff; /* White text color */
        }

        .navbar-nav .nav-link:hover {
            color: #f8f9fa; /* Lighter text color on hover */
        }

        .fixed-top {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: top 0.3s;
        }

        .fixed-top.navbar-scrolled {
            background-color: #23272b; /* Darker background color when scrolled */
        }

        .fixed-top.navbar-scrolled .navbar-brand,
        .fixed-top.navbar-scrolled .nav-link {
            color: #ffffff; /* Change text color when scrolled */
        }

        .fixed-top.navbar-scrolled .navbar-toggler-icon {
            background-image: url('data:image/svg+xml;charset=utf8,%3Csvg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath stroke="rgba(255, 255, 255, 0.5)" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/%3E%3C/svg%3E'); /* Change navbar toggler color when scrolled */
        }
        /* Change navbar toggler to three lines */
        .navbar-toggler-icon {
            background: none; /* Remove background color */
            border: none; /* Remove border */
            width: 24px; /* Adjust width */
            height: 2px; /* Adjust height */
            position: relative;
        }

        /* Add three lines */
        .navbar-toggler-icon::before,
        .navbar-toggler-icon::after {
            content: '';
            display: block;
            background-color: #fff; /* Color of the lines */
            width: 100%;
            height: 2px; /* Adjust line thickness */
            position: absolute;
            transition: transform 0.3s ease; /* Add transition for animation */
        }

        /* Position lines */
        .navbar-toggler-icon::before {
            top: -6px; /* Position the first line */
        }

        .navbar-toggler-icon::after {
            bottom: -6px; /* Position the third line */
        }

        /* Rotate lines for animation when toggled */
        .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon::before {
            transform: rotate(45deg); /* Rotate first line */
        }

        .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon::after {
            transform: rotate(-45deg); /* Rotate third line */
        }

        .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon {
            background: transparent; /* Hide middle line */
        }        .dropdown-item {
                    color: #343a40;
                }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input,
        textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            box-sizing: border-box;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        button {
            cursor: pointer;
            margin-right: 10px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }

        th,
        td {
            border: 3px solid #ddd;
            padding: 8px;
            text-align: left;
            border-radius: 6px;
        }

        th {
            background-color: #F5F5F5;
            color: black;
            font-weight: bold;
            padding: 6px;
            border-radius: 6px;
        }

        td {
            border: 3px solid #ddd;
            border-radius: 6px;
        }

        h2 {
            text-align: left;
            margin-bottom: 20px;
        }

        .vsp-links {
            text-align: right;
            margin-top: 20px;
        }

        /* Styles for the dropdown */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            width: 100%;
            box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
            z-index: 1;
            text-align: left;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }
        .dropdown-menu {
            right: 0;
            left: auto;
        }
        .how-to-use-button{
            padding-top: 50px;
            transition: padding-top 0.3s ease;
            font-size: 20px;

        }

        .how-to-use-button:hover{
            padding-top: 85px;
        }
@media (max-width: 576px) {
    /* for useful links button remains visible on small screens */
    .navbar-nav .dropdown-toggle {
        display: block !important;
    }

    /* margin adjustments to create space for dropdown */
    .navbar-nav .dropdown-menu {
        right: auto;
        left: 0;
        margin-top: 0;
    }
}
    @media (max-width: 576px) {
        /* dropdown menu remains visible on small screens */
        .navbar-nav .dropdown-menu {
            position: static;
            float: none;
        }

        /* dropdown menu items to display vertically */
        .dropdown-menu a {
            display: block;
        }
    }
    </style>
</head>

<body>
<nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
        <a class="navbar-brand" href="#">VsP</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">

            <ul class="navbar-nav">


                <li class="nav-item dropdown">

                    <a class="nav-link dropdown-toggle" href="#" id="usefulLinksDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    For Gift Vouchers</a>
                    <div class="dropdown-menu" aria-labelledby="usefulLinksDropdown">
                        <!-- <a class="dropdown-item" href="https://docs.google.com/spreadsheets/d/1cwmvBUW8Bco_gnimGkr4BetPHMXwMlFpyRR7vMl4Hu8/edit#gid=0" target="_blank">VSP Sheet</a>
                        <a class="dropdown-item" href="https://docs.google.com/spreadsheets/d/1znbcR9VAmwlhtopqL29pMTVrI_z_AGFs/edit#gid=219291130" target="_blank">Status</a> -->
                        <a class="dropdown-item" href="https://docs.google.com/document/d/1ZOGdUfyXb0XWu-swrG5kjQ0PQ7IiWlQHyEgfs2vocic/edit" target="_blank">Gift Voucher Mail Format</a>
                        <a class="dropdown-item" href="https://docs.google.com/spreadsheets/d/1Y3NcPwCWAj5i7IdYvjMSpM-9k3s2Zhytc6AE_357WiA/edit#gid=1273473002" target="_blank">Gift Voucher Service List</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</nav>

    <div id="popupOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); align-items: center; justify-content: center; z-index: 999;color: black;">
        <div style="background: white; padding: 20px; border-radius: 5px;">
            <p id="popupMessage"></p>
        </div>
    </div>

    <div class="container">
        
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2 class="generate-mail-heading" style="padding-top: 95px;">Confirmation Mail</h2>
            <a style=" font-weight: bold; background-color: #131921; color: #FF613E; border: none;" href="https://www.loom.com/share/8df1c52086094125a4d05c33b2d68f74?sid=00c2ccce-471c-4c73-a342-54048cc76297" target="_blank" class="btn btn-info how-to-use-button" onclick="showHowToUse()">How to Use?<br>Click Here</a>
        </div>

        <form id="emailForm" style="padding-top: 20px;">
            <label for="vendorDetails" style="font-weight: bold;">Vendor Details: <span style="font-weight: lighter;font-style: italic;">(Copy data from "FeedID" to "Seller" column by dragging and paste it in the first column below)</span></label>

            <table class="table" id="vendorDetailsTable" style="box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Add shadow */">
                <thead>
                    <tr>
                        <th style="font-weight: normal;">Feed ID</th>
                        <th style="font-weight: normal; display: none;">Type</th>
                        <th style="font-weight: normal; display: none;">Title</th>
                        <th style="font-weight: normal; display: none;">SKU</th>
                        <th style="font-weight: normal;">Service</th>
                        <th style="font-weight: normal;">Seller</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="vendorRow">
                        <td><input type="text" class="form-control feedid" id="feedId" required></td>
                        <td style="display: none;"><input type="text" class="form-control type" required></td>
                        <td style="display: none;"><input type="text" class="form-control title" required></td>
                        <td style="display: none;"><input type="text" class="form-control sku" required></td>
                        <td><input type="text" class="form-control category" id="serviceName" required></td>
                        <td><input type="text" class="form-control seller" id="vendorName" required></td>
                    </tr>
                </tbody>
            </table>
 
            <label for="claimsDetails" style="font-weight: bold;padding-top: 20px;">Claims Details: <span style="font-weight: lighter;font-style: italic;">(Copy data from "Department Name" to "Designation" column by dragging and paste it in the first column below)</span></label>
            <table class="table" id="claimsDetailsTable" style="box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Add shadow */">
                <thead>
                    <tr>
                        <th style="font-weight: normal;">S.No</th>
                        <th style="font-weight: normal;">Department Name</th>
                        <th style="font-weight: normal;">Work Order Number</th>
                        <th style="font-weight: normal;">Project Value</th>
                        <th style="font-weight: normal;">Project Start Date</th>
                        <th style="font-weight: normal;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal; display: none;">Project End Date</th>
                        <th style="font-weight: normal;">Buyer Designation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="claimRow">
                        <td><button type="button" style="background-color: #CDCDCD; border: none; color: black;" id="clearAllButton" class="btn btn-danger" onclick="clearClaimsDetailsTable()">Clear</button></td>
                        <td><input type="text" class="form-control workOrderNumber" required ></td>
                        <td><input type="text" class="form-control buyerDepartment" required></td>
                        <td><input type="text" class="form-control projectValue" required></td>
                        <td><input type="text" class="form-control startDate" required></td>
                        <td><input type="text" class="form-control endDate" required></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text"  class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td style="display:none;"><input type="text" class="form-control endDate" required ></td>
                        <td><input type="text" class="form-control BuyerDesignation" required></td>
                    </tr>
                </tbody>

            </table>
            <div class="buttons" style="padding: 15px 2px 5px 2px; align-items: center; display: flex; justify-content: center;">
                <button type="button" style="background-color: #5CB85B; border: none;" class="btn btn-primary" onclick="generateEmail()">Generate Mail</button>
                <button type="button" style="background-color: #D8534E; border: none;"class="btn btn-info" onclick="copyToClipboard()">Copy Mail</button>
                <button type="button" style=" border: none;"class="btn btn-info" onclick="copySubject()">Copy Subject</button>
            </div>
        </form>
       <hr>

        <h3>Email Preview:</h3>
         <div id="emailSubject" style="visibility: none;"></div>
        <div id="emailPreview"></div>
    </div>
    <script>
    function clearClaimsDetailsTable() {
        console.log("Clear button clicked");
        var claimsDetailsTable = document.getElementById('claimsDetailsTable');
        var claimsDetailsBody = claimsDetailsTable.getElementsByTagName('tbody')[0];
        
        // Getting all rows in the table body
        var rows = claimsDetailsBody.getElementsByTagName('tr');

        //iterating from the second row (index 1) to the last row
        for (var i = 1; i < rows.length; i++) {
            // Remove the current row
            claimsDetailsBody.removeChild(rows[i]);
        }
    }
    </script>
    <script>
        function generateEmail() {
            var vendorName = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByClassName('seller')[0].value;
            var serviceName = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByClassName('category')[0].value;
            var feedId = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByClassName('feedid')[0].value;

            console.log("Vendor Name:", vendorName);
            console.log("Service Name:", serviceName);
            console.log("Feed ID:", feedId);
            console.log("Buyer Designation:", buyerDesignation);
            console.log("Buyer Department:", buyerDepartment);
            

            var claimsDetailsTable = document.getElementById('claimsDetailsTable');
            var claimsDetailsBody = claimsDetailsTable.getElementsByTagName('tbody')[0];
            var rows = claimsDetailsBody.getElementsByTagName('tr');
            var claimsDetails = '';

            for (var i = 1; i < rows.length; i++) { // Start from 1 to EXclude header row
                var cells = rows[i].getElementsByTagName('td');
                var buyerDepartment = cells[1].textContent;
                var workOrderNumber = cells[2].textContent;
                var projectValue = cells[3].textContent;
                var startDate = cells[4].textContent;
                var endDate = cells[5].textContent;
                var buyerDesignation = cells[14].textContent;

                claimsDetails += `<tr>
                                    <td>${i}</td>
                                    <td>${workOrderNumber}</td>
                                    <td>${projectValue}</td>
                                    <td>${startDate}</td>
                                    <td>${endDate}</td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
            }
        // Concatenate buyer name with designation and department separated by comma
            var buyerName = buyerDesignation + ', ' + buyerDepartment;
            
            var subject = `To seek confirmation regarding ${vendorName} registering as a service provider on the GeM portal.`;
            var emailTemplate = `Dear Sir/Ma’am,<br>
            Greetings from GeM!<br>
            <br>
            This is to seek confirmation regarding ${vendorName} registering as a service provider on the GeM portal. The seller claims to have provided the following:<br>
            Service Name: ${serviceName}<br>
            Buyer Name: ${buyerName}<br>
            <br>
            Below are the details shared by the service provider (feed ID: ${feedId}) on the GeM portal for further verification.<br>
            <table style="border: 1px solid black; border-collapse: collapse;">
                <tr>
                    <th rowspan="2">S.No.</th>
                    <th colspan="4">Claims as per the Service Provider</th>
                    <th colspan="2">To be filled by the recipient department</th>
                </tr>
                <tr>
                    <th>Work Order Number</th>
                    <th>Project Value</th>
                    <th>Project Start Date</th>
                    <th>Project End Date</th>
                    <th>Confirmation (Y/N)</th>
                    <th>Remarks(If any)</th>
                </tr>
                ${claimsDetails}
            </table>
            <br>
            <br>
            <i><b>Note:</b> The completion document/work order/relevant documents (the document uploaded by the service provider) has been attached for your reference.</i><br>
            <br>
            Please revert to the same mail in Yes/No if credentials mentioned above are correct as per your records.<br>
            <br>
            Yes–If documents/details provided are authentic<br>
            No–If documents/details provided are not authentic<br>
            <br>
            In this regard, we request you to please confirm whether the document submitted by the service provider is true and correct or not. The document uploaded by the service provider has been attached for your reference.<br>
            <br>
            Request you to please reply to the mail at the earliest of your convenience or within the next 4 days. In case of any query, please contact the undersigned.<br>
            <br>
            Also, please be informed that the GeM is a trust-based portal and therefore, it is imminent to verify the documents submitted by the service providers from the concerned Buyer department, otherwise, it may lead to possible forgery at the GeM portal. Considering the gravity of the situation, we request you to please take this on an urgent basis.<br>
            <br>
            Thanking You,<br>
            Ganesh K Ingole<br>
            Contact: 8600017722<br>
            Government e-Marketplace (GeM)<br>
            Ministry of Commerce & Industry`;

            document.getElementById('emailPreview').innerHTML = emailTemplate;
            document.getElementById('emailSubject').innerText = subject;
            showPopup('Email generated successfully!');
            // e.stopPropagation();
        }
            $(document).ready(function () {
                $('.dropdown-toggle').dropdown();
            });
            function showPopup(message) {
                // Set the popup message
                document.getElementById('popupMessage').innerText = message;

                // Show the overlay
                document.getElementById('popupOverlay').style.display = 'flex';

                // Hide the overlay after 3 seconds
                setTimeout(function () {
                    document.getElementById('popupOverlay').style.display = 'none';
                }, 1000);
            }

            function copyToClipboard() {
                    var emailPreview = document.getElementById('emailPreview');
                    var range = document.createRange();
                    range.selectNode(emailPreview);
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                    document.execCommand('copy');
                    window.getSelection().removeAllRanges();
                    showPopup('Email copied to clipboard!');
                }

           function copySubject() {
                    var emailSub = document.getElementById('emailSubject');
                    var range = document.createRange();
                    range.selectNode(emailSub);
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                    document.execCommand('copy');
                    window.getSelection().removeAllRanges();
                    showPopup('Subject copied to clipboard!');
                }

                document.addEventListener('contextmenu', function (e) {
                  e.preventDefault();
                });
               document.addEventListener('contextmenu', function (e) {
                    e.preventDefault();
                });  
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.8/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
    // Function to clear input fields in the claims details table

    document.getElementById('clearAllButton').addEventListener('click', clearClaimsDetailsTable);
    </script>
    <script>
                document.addEventListener('DOMContentLoaded', function () {
                    document.getElementById('claimsDetailsTable').addEventListener('paste', handlePaste);
                });
        function handlePaste(e) {
            var clipboardData, pastedData;

            // Get clipboard data
            clipboardData = e.clipboardData || window.clipboardData;
            pastedData = clipboardData.getData('text');

            // Split pasted data into rows and columns
            var rows = pastedData.split('\n');

            // Get the tbody element of the claimsDetailsTable
            var tbody = document.getElementById('claimsDetailsTable').getElementsByTagName('tbody')[0];

            // Get the current number of rows in the table
            var existingRowCount = tbody.getElementsByTagName('tr').length;

            // Create a new row for pasted data
            var newRow = document.createElement('tr');

            // Create and append the serial number cell
            var serialNumberCell = document.createElement('td');
            serialNumberCell.textContent = existingRowCount; // Serial number for the new row
            newRow.appendChild(serialNumberCell);

            // Loop through each row of pasted data
            for (var i = 0; i < rows.length; i++) {
                var rowData = rows[i].split('\t');

                // Loop through each column of pasted data
                for (var j = 0; j < 5; j++) { // Loop through first 5 columns
                    var newCell = document.createElement('td');
                    newCell.textContent = rowData[j];
                    newRow.appendChild(newCell);
                }

                // Add the last column
                var lastColumnCell = document.createElement('td');
                lastColumnCell.textContent = rowData[rowData.length - 1]; // Last column
                newRow.appendChild(lastColumnCell);
            }

            // Append the new row to the tbody
            tbody.appendChild(newRow);

            // Hide the columns to hide
            hideColumns();

            e.preventDefault(); // To Prevent default paste behavior
        }

        function hideColumns() {
            var tableRows = document.getElementById('claimsDetailsTable').getElementsByTagName('tr');
            for (var i = 0; i < tableRows.length; i++) {
                var cells = tableRows[i].getElementsByTagName('td');
                for (var j = 1; j < cells.length - 1; j++) { // Hide columns except the first 5 and the last column
                    if (j <= 5 || j === cells.length - 1) { // Show first 5 and last column, hide the rest
                        cells[j].style.display = '';
                    } else {
                        cells[j].style.display = 'none';
                    }
                }
            }
        }


        function handleVendorPaste(e) {
            var clipboardData, pastedData;

            // Get clipboard data
            clipboardData = e.clipboardData || window.clipboardData;
            pastedData = clipboardData.getData('text');

            // Split pasted data into rows and columns
            var rows = pastedData.split('\n');
            var firstRowCells = document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr')[0].getElementsByTagName('td');

            // Loop through each row of pasted data
            for (var i = 0; i < rows.length; i++) {
                var rowData = rows[i].split('\t');
                if (rowData.length !== firstRowCells.length) {
                    alert('Pasted data does not have the correct number of columns.');
                    return;
                }

                // Update the cells of the first row with pasted data
                for (var j = 0; j < rowData.length; j++) {
                    // Check if the cell exists
                    if (firstRowCells[j]) {
                        // Update the cell value
                        firstRowCells[j].getElementsByTagName('input')[0].value = rowData[j].trim();
                    } else {
                        // If the number of cells in the pasted data exceeds the number of cells in the table, add a new row
                        var newRow = document.createElement('tr');
                        for (var k = 0; k < rowData.length; k++) {
                            var newCell = document.createElement('td');
                            newCell.innerHTML = '<input type="text" class="form-control" value="' + rowData[k].trim() + '" required>';
                            newRow.appendChild(newCell);
                        }
                        document.getElementById('vendorDetailsTable').getElementsByTagName('tbody')[0].appendChild(newRow);
                    }
                }
            }

            e.preventDefault(); // Prevent default paste behavior
        }

        // Attach the handleVendorPaste function to the paste event of the vendorDetailsTable
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('vendorDetailsTable').addEventListener('paste', handleVendorPaste);
        });
    </script>

</body>
</html>
